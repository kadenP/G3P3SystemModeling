HX_ = HX();
HX_.n = 5;
t = 0:1200:3600*6;
Ts_in = 775;
Tco2_in = 550;
mdot_s_in = 9;
mdot_CO2_in = 5;
Ts_out = zeros(size(t)); Ts_out(1) = HX_.Ts0;
Tco2_out = zeros(size(t)); Tco2_out(1) = HX_.Tco20;
mdot_s_out = zeros(size(t)); mdot_s_out(1) = mdot_s_in;
mdot_CO2_out = zeros(size(t)); mdot_CO2_out(1) = mdot_CO2_in;
Ts = cell(size(t)); Ts{1} = HX_.Ts0*ones(HX_.n, 1);
Tco2 = cell(size(t)) Tco2{1} = HX_.Tco2*ones(HX_.n, 1);
Tm = cell(size(t));
Q_CO2 = zeros(size(t));

for i = 2:length(t)
    [Ts_out, Tco2_out, mdot_s_out, mdot_CO2_out, Ts, Tco2, ...
                Tm, Q_CO2] = step(HX_, Ts_in, Tco2_in, mdot_s_in, ...
                mdot_CO2_in, t(i));
end